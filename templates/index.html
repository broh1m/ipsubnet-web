<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subnet Calculator with VLAN</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container mt-5">
        <button class="btn btn-outline-secondary theme-switch" onclick="toggleTheme()" title="Toggle Dark Mode">
            <i class="bi bi-moon-fill"></i>
        </button>

        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card p-4 animate__animated animate__fadeIn">
                    <h1 class="animate__animated animate__fadeInDown">
                        <i class="bi bi-diagram-3-fill me-2"></i>
                        Subnet Calculator with VLAN
                    </h1>

                    <div class="d-flex justify-content-end mb-4">
                        <a href="{{ url_for('notes') }}" class="btn btn-outline-primary">
                            <i class="bi bi-journal-text me-2"></i>Notes
                        </a>
                    </div>

                    <form method="POST" action="/" id="subnetForm" class="animate__animated animate__fadeIn">
                        <div class="mb-4">
                            <label for="network_ip" class="form-label">Network IP (CIDR notation)</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="bi bi-globe"></i></span>
                                <input type="text" class="form-control" id="network_ip" name="network_ip" required 
                                       placeholder="e.g. 192.168.1.0/24" value="{{ network_ip or '' }}"
                                       pattern="^(\d{1,3}\.){3}\d{1,3}/\d{1,2}$">
                            </div>
                            <div class="form-text">Format: xxx.xxx.xxx.xxx/xx (e.g., 192.168.1.0/24)</div>
                        </div>

                        <div class="mb-4">
                            <label for="num_segments" class="form-label">Number of Network Segments</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="bi bi-diagram-2"></i></span>
                                <input type="number" class="form-control" id="num_segments" name="num_segments" required 
                                       min="1" max="64" value="{{ num_segments or '' }}">
                            </div>
                            <div class="form-text">Maximum 64 segments allowed</div>
                        </div>

                        <div class="mb-4">
                            <label for="vlan_start" class="form-label">Starting VLAN ID</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="bi bi-hash"></i></span>
                                <input type="number" class="form-control" id="vlan_start" name="vlan_start" required 
                                       min="1" max="4094" value="{{ vlan_start or '1' }}">
                            </div>
                            <div class="form-text">VLAN ID range: 1-4094</div>
                        </div>

                        <div class="text-center">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="bi bi-calculator me-2"></i>Calculate
                            </button>
                        </div>
                    </form>

                    {% if error %}
                    <div class="alert alert-danger mt-4 animate__animated animate__fadeIn">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i>{{ error }}
                    </div>
                    {% endif %}

                    <div class="loading-spinner">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>

                    {% if results %}
                    <div class="results-container mt-4 show">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h3 class="mb-0">
                                <i class="bi bi-table me-2"></i>Subnet Results
                            </h3>
                            <button class="btn btn-success" onclick="exportToCSV()">
                                <i class="bi bi-download me-2"></i>Export to CSV
                            </button>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped" id="resultsTable">
                                <thead>
                                    <tr>
                                        <th>VLAN ID</th>
                                        <th>Network ID</th>
                                        <th>Subnet Mask</th>
                                        <th>Broadcast IP</th>
                                        <th>Default Gateway</th>
                                        <th>Usable Hosts</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for row in results %}
                                    <tr class="animate__animated animate__fadeIn">
                                        <td>{{ row.vlan_id }}</td>
                                        <td>{{ row.network_id }}</td>
                                        <td>{{ row.subnet_mask }}</td>
                                        <td>{{ row.broadcast }}</td>
                                        <td>{{ row.default_gateway }}</td>
                                        <td>{{ row.usable_hosts }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <footer class="footer mt-5 py-4">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto text-center">
                    <h4 class="mb-3"><i class="bi bi-info-circle-fill me-2"></i>About This Tool</h4>
                    <p class="mb-3">This subnet calculator helps network administrators divide a network into smaller, more manageable segments while maintaining proper IP addressing and VLAN configuration.</p>
                    
                    <div class="row mt-4">
                        <div class="col-md-4">
                            <div class="feature-item">
                                <i class="bi bi-globe feature-icon"></i>
                                <h5>Network Division</h5>
                                <p>Split your network into multiple segments with proper subnetting</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="feature-item">
                                <i class="bi bi-hash feature-icon"></i>
                                <h5>VLAN Support</h5>
                                <p>Assign VLAN IDs to each network segment (1-4094)</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="feature-item">
                                <i class="bi bi-table feature-icon"></i>
                                <h5>Detailed Results</h5>
                                <p>View network ID, subnet mask, broadcast IP, and more</p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4">
                        <p class="text-muted">Enter a network IP in CIDR notation (e.g., 192.168.1.0/24) and specify the number of segments needed. The calculator will automatically determine the optimal subnet configuration.</p>
                    </div>

                    <div class="mt-4 pt-3 border-top">
                        <p class="text-muted mb-0">
                            <i class="bi bi-c-circle me-1"></i>KLASIK 2025â„¢
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/network-animation.js') }}"></script>
    <script>
        // Function to set theme
        function setTheme(theme) {
            const html = document.documentElement;
            html.setAttribute('data-bs-theme', theme);
            
            const icon = document.querySelector('.theme-switch i');
            icon.className = theme === 'dark' ? 'bi bi-sun-fill' : 'bi bi-moon-fill';
            
            // Store theme preference
            localStorage.setItem('theme', theme);
        }

        // Function to toggle theme
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-bs-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            setTheme(newTheme);
        }

        // Initialize theme from localStorage on page load
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            setTheme(savedTheme);
        });

        function exportToCSV() {
            const table = document.getElementById('resultsTable');
            const rows = table.querySelectorAll('tr');
            let csv = [];
            
            for (const row of rows) {
                const cells = row.querySelectorAll('th, td');
                const rowData = Array.from(cells).map(cell => `"${cell.textContent}"`);
                csv.push(rowData.join(','));
            }
            
            const csvContent = csv.join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'subnet_results.csv';
            link.click();
        }

        // Form validation and submission handling
        document.getElementById('subnetForm').addEventListener('submit', function(e) {
            const networkIp = document.getElementById('network_ip').value;
            const ipPattern = /^(\d{1,3}\.){3}\d{1,3}\/\d{1,2}$/;
            
            if (!ipPattern.test(networkIp)) {
                e.preventDefault();
                alert('Please enter a valid IP address in CIDR notation (e.g., 192.168.1.0/24)');
                return;
            }

            const segments = parseInt(document.getElementById('num_segments').value);
            if (segments < 1 || segments > 64) {
                e.preventDefault();
                alert('Number of segments must be between 1 and 64');
                return;
            }

            const vlanStart = parseInt(document.getElementById('vlan_start').value);
            if (vlanStart < 1 || vlanStart > 4094) {
                e.preventDefault();
                alert('VLAN ID must be between 1 and 4094');
                return;
            }

            // Show loading spinner
            document.querySelector('.loading-spinner').classList.add('show');
        });

        // Initialize tooltips
        const tooltipTriggerList = [].slice.call(document.querySelectorAll('[title]'));
        tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });
    </script>
</body>
</html> 